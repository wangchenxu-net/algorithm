---
title: 插入排序
tag:
  - 排序
---

原理  
--------

以从小到大排序为例：
1. 将第一项作为已排好的队列中的唯一一项
2. 从第二项开始依次将每一项按照3~5的步骤插入到已排好的队列中
3. 将要插入的项目暂存
4. 从已排好序的最后一项开始，比较其要插入的项目，如果其大于要插入的项目，则将其后移；直到第一项或者对应项不大于要插入的项目
5. 如果要插入项为当前最小值，则将其赋值到到第一项，否则将其赋值到最后比较项的后移位置

时间复杂度
--------

若初始状态为正序，每插入一项时，都只比较一次，和赋值两次，所需的比较次数、赋值次数都达到最小值：
```math
\begin{aligned}
&C_{min} = n - 1 = O(n) \\
&M_{min} = 2( n - 1 ) = O(n)
\end{aligned}
```
所以，最好的时间复杂度为 $O(n)$.

若初始状态是逆序，每插入一项时，第 $i$ 都要和前面 $i - 1$ 项比较，且前$i - 1$需要移动一次，而第 $i$ 项需要赋值两次，则比较次数与赋值次数均为最大：
```math
\begin{aligned}
&C_{max} = \sum_{i = 2}^{n} i - 1 = \frac{n (n - 1)}{2} = O(n^2) \\
&M_{max} = \sum_{i = 2}^{n} i + 1 = \frac{n (n - 1)}{2} + 2 n - 2 = O(n^2)
\end{aligned}
```

所以，最坏的的时间复杂度为 $O(n^2)$

空间复杂度
-------
因为排序自始至终使用的是同一组存储控件，外加一个暂存控件和两个计数空间，所以控件复杂度为$O(n)$
